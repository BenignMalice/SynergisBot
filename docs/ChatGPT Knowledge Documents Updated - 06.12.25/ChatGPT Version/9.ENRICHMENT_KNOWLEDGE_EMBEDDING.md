# ENRICHMENT_KNOWLEDGE_EMBEDDING
# OFFICIAL ENRICHMENT SIGNAL FRAMEWORK

# PURPOSE
Define all enrichment signals and their allowed influence on analysis:
- volatility context
- momentum context
- micro-alignment
- divergence
- liquidity & orderflow context
- statistical anomalies
- pattern detection

Enrichments supply **context only**.  
They do NOT replace:
- structure
- BOS / CHOCH
- displacement
- liquidity rules
- volatility rules
- regime classification
- required plan conditions

---

# SYSTEM HIERARCHY & OVERRIDE ORDER
This file ALWAYS defers to:
1. KNOWLEDGE_DOC_EMBEDDING (OS Layer)
2. Professional Reasoning Layer (PRL)
3. Auto-Execution Knowledge Embedded
4. Breakout Workflow Embedded
5. Volatility & Regime Framework
6. Symbol-specific reference docs

If ANY conflict occurs → higher document wins.

---

# PRL DEPENDENCY
Enrichment interpretation is allowed ONLY after PRL stages:

1. price_fetch_required  
2. regime_classification  
3. strategy_selection  
4. volatility_structure_conflict_check  
5. session_filter  
6. news_filter  
7. structure_liquidity_validation  

If ANY PRL stage fails → enrichment interpretation MUST NOT proceed.

---

# PRICE DEPENDENCY
Enrichment signals require:
- fresh price via tool: moneybot.getCurrentPrice
- parameters: `symbol` (string, required)
- example: `moneybot.getCurrentPrice(symbol: "XAUUSD")`
- no cached or implied values
- no historical reconstruction

# ANALYSIS_TOOL_DEPENDENCY
Enrichment data is provided by:
- tool: moneybot.analyse_symbol_full (primary source for enrichment data)
- parameters: `symbol` (string, required)
- returns: All enrichment fields in `response.data` structure
- includes: Volatility, ATR, momentum, divergence, pattern detection, proximity to key levels, HTF bias hints
- for BTC: Also includes Binance enrichments (tick_rate, liquidation_clusters, spot_perp_delta, aggressive_taker_imbalance, binance_mt5_price_divergence)
- example: `moneybot.analyse_symbol_full(symbol: "BTCUSD")`

Price is mandatory for:
- volatility evaluation  
- momentum slope  
- divergence direction  
- liquidity proximity  
- distance_to_key_levels  
- pattern location  

If price not available → enrichments suppressed.

---

# SCOPE

## MT5_ENRICHMENTS (ALL SYMBOLS)
mt5_fields:
  - volatility
  - ATR behaviour
  - momentum
  - spread
  - divergence (non-CVD)
  - pattern_detection
  - proximity_to_key_levels
  - higher_timeframe_bias_hint

## BINANCE_ENRICHMENTS (BTC ONLY)
btc_binance_fields:
  - tick_rate
  - liquidation_clusters
  - spot_perp_delta
  - aggressive_taker_imbalance
  - binance_mt5_price_divergence

## PATTERN_DETECTION (ALL SYMBOLS)
patterns:
  - engulfing
  - pin_bar
  - hammer
  - doji
  - inside_bar
  - outside_bar
  - spinning_top
  - marubozu
  - volatility_trap
  - pivot_rejection

---

# UNIFIED ENRICHMENT FIELDS

## STRUCTURAL_CONTEXT (CONTEXT ONLY)
structural_context:
  - swing_compression
  - swing_expansion
  - premium_discount_location
  - distance_to_key_levels
  - liquidity_proximity
  - imbalance_equilibrium_zones
  - htf_bias_hint
  - micro_alignment (btc, xau, eurusd only)

Enrichments DO NOT confirm:
  - BOS  
  - CHOCH  
  - trend  
  - reversal  
  - liquidity break  
  - displacement  

---

## VOLATILITY CONTEXT
volatility_fields:
  - atr_value
  - atr_slope
  - volatility_state (low / medium / high / unstable)
  - compression_phase
  - expansion_phase
  - exhaustion_phase
  - volatility_instability_warning
  - m1_spike_alert (btc/xau/eurusd only)

## MOMENTUM CONTEXT
momentum_fields:
  - momentum_score
  - momentum_slope
  - momentum_exhaustion
  - overextension_warning
  - momentum_divergence

## SPREAD CONTEXT
spread_fields:
  - spread_value
  - spread_widening
  - spread_compression
  - spread_safety_flag

## MICRO-ALIGNMENT (BTC, XAU, EURUSD ONLY)
micro_alignment_fields:
  - m1_m5_m15_alignment
  - micro_sweep_confirmation
  - micro_impulse_pullback_profile
  - microtrend_agreement

## DIVERGENCE
divergence_fields:
  - rsi_divergence
  - macd_divergence
  - volume_divergence
  - momentum_divergence
  - cvd_divergence (btc_only)

## LIQUIDITY & ORDERFLOW CONTEXT
liquidity_orderflow:
  mt5:
    - proximity_to_liquidity_pools
    - sweep_probability_context
    - compression_liquidity_zones
  btc_binance:
    - taker_aggression
    - liquidation_cluster_proximity
    - spot_perp_delta
    - orderflow_imbalance

## TICK ACTIVITY (BTC ONLY)
tick_fields:
  - tick_rate_acceleration
  - tick_rate_decline
  - impulse_vs_drift_classification
  - burst_warning

## STATISTICAL ANOMALIES
z_score_fields:
  - volatility_z
  - deviation_z
  - tickrate_z
  - volume_z

---

# ENRICHMENT RULES (MANDATORY)

## CONTEXT_ONLY_RULE
enrichments_do_not:
  - confirm structure  
  - confirm trend  
  - generate setups  
  - create BOS or CHOCH  
  - override MT5 structure  
  - override volatility logic  
  - bypass session or news filters  

## STRUCTURE_PRIORITY_RULE
mt5_structure_overrides:
  - enrichments  
  - divergence  
  - micro_alignment  
  - volatility context  

## VOLATILITY-STRUCTURE CONFLICT RULE
If enrichments suggest direction but PRL volatility/structure block:
  - structure_and_volatility_win  
  - enrichment interpretation suppressed  

---

# SYMBOL RESTRICTIONS

btc_only:
  - tick_rate  
  - liquidation_clusters  
  - spot_perp_delta  
  - cvd_divergence  
  - binance_mt5_price_divergence  

micro_alignment_allowed_for:
  - btc  
  - xau  
  - eurusd  

all_symbols:
  - patterns  
  - mt5_volatility  
  - ATR  
  - momentum  
  - spread  
  - key_levels  

unsupported_for:
  - exotic FX  
  - metals other than XAU  
  - indices  
  unless user provides explicit external enrichment data

---

# CONFLUENCE EFFECTS

increase_confluence_when:
  - volatility_contraction + clean_sweep  
  - micro_alignment_agrees_with_confirmed_structure  
  - momentum_slope_supports_direction  
  - pattern_reinforces_bias  

decrease_confluence_when:
  - spread_widening  
  - volatility_instability  
  - conflicting_micro_alignment  
  - strong_divergence_against_structure  

Confluence modifies **confidence ONLY**.  
Confluence NEVER:
  - validates a setup  
  - activates a strategy  
  - bypasses structural requirements  

---

# PLAN INTERACTION RULES

enrichments_can:
  - increase plan quality  
  - decrease plan quality  
  - annotate contextual risk  
  - support confidence scoring  

enrichments_cannot:
  - become required conditions  
  - create entry triggers  
  - replace structure  
  - override volatility  
  - override session  
  - override news  
  - override validation layer  

---

# IGNORE ENRICHMENTS WHEN
ignore_rules:
  - friendly_chat  
  - price_fetch_failure  
  - unsupported_symbol  
  - conceptual_questions  
  - news_blackout (unless risk_requested)  
  - contradiction_with_confirmed_structure  

---

# SAFETY RULES
enrichments_must_not:
  - generate predictions  
  - generate trade signals  
  - invent data  
  - infer missing fields  
  - override safety or PRL  
  - carry bias across messages  

---

# SUMMARY
This document defines:
- unified enrichment fields  
- symbol-specific rules  
- volatility/momentum/spread/divergence/micro-alignment models  
- strict context-only behaviour  
- confluence scoring rules  
- integration with PRL, volatility, structure, liquidity, sessions, and auto-exec validation  

Enrichments **support** analysis but never validate or trigger trades.

# END_OF_DOCUMENT
