# LONDON_BREAKOUT_STRATEGY_EMBEDDED

# PURPOSE
Define deterministic rules for executing London Breakout Strategy:
- session-gated
- volatility-gated
- structure-gated
- regime-dependent
- strict validation logic
Strategy only activates when ALL conditions pass.

# STRATEGY_TYPE_MAPPING
**Critical**: "London Breakout" is a workflow/analysis method, not a StrategyType enum value.
When creating auto-execution plans for London Breakout setups:
- **Workflow**: Follow LONDON_BREAKOUT_ANALYSIS_WORKFLOW_EMBEDDING.md for validation
- **Strategy Type**: Use `strategy_type: "breakout_ib_volatility_trap"` in the plan
- **Reasoning**: London Breakout is a specific application of the Inside Bar Volatility Trap strategy
The workflow determines if the setup is valid, but the enum value used in the plan is `breakout_ib_volatility_trap`.

# SCOPE
applies_to:
  - forex_majors
  - xauusd
  - btcusd (with micro_alignment allowed)

not_valid_for:
  - extreme_spread_conditions
  - high_impact_news_window
  - chop_regimes
  - volatility_shock_sessions

# VALIDATION_LAYER (MUST PASS ALL)

market_regime_valid:
  - trending
  - ranging_expansion
  - compression_expansion
not_valid_regimes:
  - chop
  - volatility_shock
  - exhausted_trend

asian_range_requirements:
  - asian_high_intact
  - asian_low_intact
  - no_pre_london_breakout
  - range_clean (no messy liquidity)

structure_requirements:
  - htf_bias_not_contradictory
  - no_recent_opposite_CHOCH (3–5 candles)
  - displacement_required_if_using_sweep_model
  - liquidity_pool_identifiable

volatility_requirements:
  - atr_rising_or_stable
  - no_prelondon_volatility_spike
  - spread_within_limits
  - volatility_not_collapsing

session_requirements:
  - london_session_only (07:00–10:00 UTC)
  - no_high_impact_news_±30m

liquidity_requirements:
  - asian_liquidity_intact
  - clear_target_liquidity_beyond_breakout
  - no_htf_absorption_at_boundary

all_layers_must_pass: true

# STRATEGY_SELECTION
select_london_breakout_when:
  - asian_range_clean
  - volatility_supportive
  - structure_not_conflicting
  - session_active
  - liquidity_positioning_valid

fallback_strategies_if_invalid:
  - range_scalp
  - sweep_reversion
  - volatility_trap
  - trend_continuation_non_breakout

# BREAKOUT_MODES

mode_classification:
  scalp_breakout:
    conditions:
      - tight_asian_range
      - moderate_volatility
      - first_displacement_small
    behaviour:
      - smaller_targets
      - quick_partials
      - short_hold_time

  trend_continuation_breakout:
    conditions:
      - strong_htf_trend
      - asian_range_as_compression
      - volatility_expanding
    behaviour:
      - larger_targets
      - continuation_logic
      - extended_hold_time

# ENTRY_RULES

breakout_continuation_entry:
  trigger:
    - break_of_asian_high_or_low
    - body_close_>50pct_outside_range
    - displacement_present
  confirmation:
    - acceptable_spread
    - no_htf_rejection
    - volatility_alignment
  allowed_entry_types:
    - immediate_continuation
    - retest_continuation

sweep_retest_breakout_entry:
  trigger:
    - sweep_asian_high_or_low
    - displacement_opposite_direction
    - retest_of_displacement_origin
  confirmation:
    - rejection_candle
    - renewed_momentum_alignment

# EXECUTION_TIMING

valid_execution_window:
  - 07:00–08:15 UTC (primary)
  - 08:15–10:00 UTC (secondary if displacement clean)

invalid_timing:
  - pre_07:00 UTC (accumulation phase only)
  - >1_hour_after_london_open
  - during_news_window

# EXCLUSION_RULES
do_not_execute_if:
  - structure_conflict_present
  - atr_collapsing
  - spread_widening
  - volatility_instability
  - asian_range_already_broken
  - liquidity_messy
  - chop_detected

# ENRICHMENT_INTEGRATION

increase_confidence_when:
  - volatility_expansion
  - momentum_alignment
  - micro_alignment_supports_direction (btc/xau/eurusd)
  - divergence_confirming_breakout
  - bullish_or_bearish_engulfing_breakout_candle
  - bb_contraction_preceding_expansion

decrease_confidence_when:
  - volatility_instability
  - spread_widening
  - divergence_against_direction
  - micro_alignment_conflicting
  - htf_liquidity_magnet_opposing

# INVALIDATION_RULES

strategy_invalid_when:
  - opposite_CHOCH_htf
  - displacement_fails
  - sweep_without_followthrough
  - volatility_collapse
  - htf_rejection_at_breakout_level

# OUTPUT_CONSTRAINTS
- no_predictions
- no_directional_calls_without_user_request
- no_plan_generation_unless_validation_passes
- no_structure_inference_without_tools
- must_reference_fresh_price_before_logic
- must_apply_news_filter
- must_apply_session_filter

# TOOL_REQUIREMENTS

## Price Fetching
- tool: moneybot.getCurrentPrice (MUST use before London Breakout analysis)
- parameters: `symbol` (string, required)
- example: `moneybot.getCurrentPrice(symbol: "XAUUSD")`

## Analysis Tool
- tool: moneybot.analyse_symbol_full (for comprehensive analysis)
- parameters: `symbol` (string, required)
- returns: Structure, volatility, Asian range data, liquidity levels
- example: `moneybot.analyse_symbol_full(symbol: "XAUUSD")`

## Plan Creation
- tool: moneybot.create_auto_trade_plan (for London Breakout plans)
- parameters: `symbol`, `direction`, `entry`, `stop_loss`, `take_profit`, `volume` (optional), `conditions` (object, REQUIRED), `strategy_type: "breakout_ib_volatility_trap"` (REQUIRED), `expires_hours` (optional)
- note: Must use `strategy_type: "breakout_ib_volatility_trap"` for London Breakout plans
- example: `moneybot.create_auto_trade_plan(symbol: "XAUUSD", direction: "BUY", entry: 2650, stop_loss: 2630, take_profit: 2690, strategy_type: "breakout_ib_volatility_trap", conditions: {...})`

# END_OF_DOCUMENT
